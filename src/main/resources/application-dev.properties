# ============================================
# DEV PROFILE - Kubernetes NodePorts
# ============================================

# Disable Dev Services (IMPORTANT!)
quarkus.devservices.enabled=false
quarkus.datasource.devservices.enabled=false
quarkus.redis.devservices.enabled=false

# ============================================
# VAULT CONFIGURATION (Kubernetes NodePort 30200)
# ============================================
quarkus.vault.url=http://localhost:30200
quarkus.vault.authentication.client-token=dev-root-token
quarkus.vault.kv-secret-engine-version=2
quarkus.vault.kv-secret-engine-mount-path=secret
quarkus.vault.tls.skip-verify=true

# Vault Config Source - Enable automatic config loading from Vault
# The extension will read from these paths and inject into application config
quarkus.vault.secret-config-kv-path=url-shorten/dev/database/postgres,url-shorten/dev/keycloak/config,url-shorten/dev/redis/config,url-shorten/dev/pulsar/config,url-shorten/dev/application/config

# ============================================
# DATABASE (PostgreSQL)
# ============================================
# Flyway Migration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.clean-at-start=false
quarkus.flyway.repair-at-start=false

# ============================================
# KEYCLOAK
# ============================================
# TLS and discovery settings (not secrets, environment-specific)
quarkus.oidc.tls.verification=none
quarkus.oidc.discovery-enabled=true
quarkus.oidc.authentication.add-openid-scope-automatically=true

# JWT Settings (not secrets, environment-specific)
smallrye.jwt.verify.aud=account
smallrye.jwt.verify.key-format=JWK
smallrye.jwt.path.groups=realm_access/roles
smallrye.jwt.claims.groups=realm_access/roles


# ============================================
# SECURITY
# ============================================
# Public endpoints (no authentication required)
quarkus.http.auth.permission.public.paths=/api/auth/register,/api/auth/login,/api/auth/refresh,/q/*,/{shortCode}
quarkus.http.auth.permission.public.policy=permit

# Authenticated endpoints
quarkus.http.auth.permission.authenticated.paths=/api/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# ============================================
# LOGGING (Dev Mode)
# ============================================
quarkus.log.level=DEBUG
quarkus.log.category."com.example".level=DEBUG
quarkus.log.category."io.quarkus.oidc".level=DEBUG
quarkus.log.category."io.quarkus.smallrye.jwt".level=DEBUG
quarkus.log.category."io.quarkus.vault".level=DEBUG

