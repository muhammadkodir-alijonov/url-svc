# ============================================
# DEV PROFILE - Kubernetes NodePorts
# ============================================

# Disable Dev Services (IMPORTANT!)
%dev.quarkus.devservices.enabled=false
%dev.quarkus.datasource.devservices.enabled=false
%dev.quarkus.redis.devservices.enabled=false

# Database (Kubernetes NodePort 30432)
%dev.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:30432/url_shortener
%dev.quarkus.datasource.username=admin
%dev.quarkus.datasource.password=admin123

# Flyway Migration
%dev.quarkus.flyway.migrate-at-start=true
%dev.quarkus.flyway.baseline-on-migrate=true

# Redis (Kubernetes NodePort 30379)
%dev.quarkus.redis.hosts=redis://localhost:30379

# Pulsar (Kubernetes NodePort 30650)
%dev.quarkus.pulsar.client.serviceUrl=pulsar://localhost:30650

# Keycloak (Kubernetes NodePort 30180)
%dev.quarkus.oidc.auth-server-url=http://localhost:30180/realms/url-shortener
%dev.quarkus.oidc.tls.verification=none

# SmallRye JWT Configuration
%dev.mp.jwt.verify.issuer=http://localhost:30180/realms/url-shortener
%dev.mp.jwt.verify.audiences=account
%dev.mp.jwt.verify.publickey.location=http://localhost:30180/realms/url-shortener/protocol/openid-connect/certs
%dev.smallrye.jwt.verify.aud=account
%dev.smallrye.jwt.verify.key-format=JWK

# Keycloak role mapping
%dev.smallrye.jwt.path.groups=realm_access/roles
%dev.smallrye.jwt.claims.groups=realm_access/roles

# Public endpoints (no authentication required)
%dev.quarkus.http.auth.permission.public.paths=/api/auth/register,/api/auth/login,/api/auth/refresh,/q/*,/{shortCode}
%dev.quarkus.http.auth.permission.public.policy=permit

# Authenticated endpoints
%dev.quarkus.http.auth.permission.authenticated.paths=/api/*
%dev.quarkus.http.auth.permission.authenticated.policy=authenticated

# App Config Overrides
%dev.app.base-url=http://localhost:3000
%dev.app.short-code.length=7
%dev.app.short-code.max-attempts=10
%dev.app.cache.url-ttl=3600
%dev.app.rate-limit.shorten=100
%dev.app.rate-limit.redirect=1000
%dev.app.pulsar.topic=url-shortener-clicks

# Dev Logging
%dev.quarkus.log.level=DEBUG
%dev.quarkus.log.category."com.example".level=DEBUG
%dev.quarkus.log.category."io.quarkus.oidc".level=DEBUG
%dev.quarkus.log.category."io.quarkus.smallrye.jwt".level=DEBUG

